{% extends "base.html" %}

{% block content %}
  <h1>Devices</h1>


  {% block search_form %}
    {% include "includes/search_form.html" %}
  {% endblock %}


<form method="get">

<form method="get" action="{% url 'device:device-list' %}">
    <label for="status">Filter by Status:</label>
    <select name="status" id="status" multiple>
<!--        <option value="">All</option>-->
        {% for status in device_status_list %}
            <option value="{{ status }}" {% if status in selected_statuses %}selected{% endif %}>{{ status }}</option>
        {% endfor %}
    </select>


    <label for="department">Filter by Department:</label>
    <select name="department" id="department" multiple>
<!--        <option value="">All</option>-->
        {% for department in department_list %}
            <option value="{{ department }}" {% if department in selected_departments %}selected{% endif %}>{{ department }}</option>
        {% endfor %}
    </select>


    <label for="site">Filter by Site:</label>
    <select name="site" id="site" multiple>
<!--        <option value="">All</option>-->
        {% for site in device_site_list %}
            <option value="{{ site }}" {% if site in selected_sites %}selected{% endif %}>{{ site }}</option>
        {% endfor %}
    </select>

    <label for="show_empty_last_inventory">
      <input type="checkbox" name="show_empty_last_inventory" id="show_empty_last_inventory" {% if show_empty_last_inventory %}checked{% endif %}>
        No inventory
    </label>

    <input type="hidden" name="device_type" value="{{ request.GET.device_type }}">

    <button type="submit">Apply Filter</button>
  </form>
  <a class="button button-gray" style="float: right;" href="{% url 'device:device-create' %}">Create</a>
  {% if device_list %}
  <p>Total devices: {{ device_list.count }}</p>
  <div class="table-responsive">
    <button id="sendSelectedDevicesButton" class="btn btn-primary">Inventaryzyj</button>
    <table class="table">
      <thead class="thead-dark">
        <tr>
          <th></th>
          <th>Name</th>
          <th>Device Type</th>
          <th>Last inventory</th>
          <th>Serial Number</th>
          <th>Status</th>
          <th>IP</th>
          <th>Ports</th>
          <th>Department</th>
          <th>Model</th>
          <th>Update</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        {% for device in device_list %}
        <tr>
          <td>
            <input type="checkbox" class="inventarisation-checkbox" data-device-id="{{ device.id }}">
          </td>
          <td><a class="text-primary" href="{% url 'device:device-detail' pk=device.id %}">{{ device.name }}</a></td>
          <td>{{ device.device_type.name }}</td>
          <td>{{ device.last_inventory|date:"Y-m-d" }}</td>
          <td>{{ device.device_serial_number }}</td>
          <td>{{ device.device_status.name }}</td>
          <td>{{ device.device_ip.ip }}</td>
          <td>
            {% if device.device_ports %}
            {% for port in device.device_ports.all %}
              {{ port.name }}
            {% endfor %}
            {% else %}
              <p>-</p>
            {% endif %}
          </td>
          <td>{{ device.department }}</td>
          <td>{{ device.device_model }}</td>
           <td><a class="text-info" href="{% url 'device:device-update' pk=device.id %}">Update</a></td>
           <td><a class="text-danger" href="{% url 'device:device-delete' pk=device.id %}">Delete</a></td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <p>There are no devices in Device!</p>
  {% endif %}



{% endblock %}
